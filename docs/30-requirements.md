# Requirements

## Must (MVP)

### ページ管理
- [ ] R1: ユーザーは新規ページを作成できる（タイトルは空でも可）
- [ ] R2: ユーザーは全ページの一覧を表示できる（タイトル、更新日時順）
- [ ] R3: ユーザーはページを削除できる（確認ダイアログあり）
- [ ] R4: ページは一意のIDを持つ（UUID推奨）

### エディタ機能
- [ ] R5: ページにタイトルを設定できる（最大200文字）
- [ ] R6: ブロックベースのエディタを実装（段落、見出しH1/H2/H3、箇条書き、番号付きリスト）
- [ ] R7: 各ブロックは個別に編集可能
- [ ] R8: ブロックを追加・削除できる（Enter/Backspaceキー）
- [ ] R9: マークダウン記法に対応（`#` 見出し、`-` 箇条書き、`**bold**`、`*italic*`）
- [ ] R10: 編集内容は2秒後に自動保存される（デバウンス処理）

### 検索機能
- [ ] R11: タイトルと本文を対象に全文検索できる
- [ ] R12: 検索結果はページ一覧形式で表示される

### データ永続化
- [ ] R13: ページデータはデータベースに保存される
- [ ] R14: 各ページにcreatedAt、updatedAtタイムスタンプを記録
- [ ] R15: 自動保存失敗時はエラーメッセージを表示

### UI/UX
- [ ] R16: サイドバーにページ一覧を表示
- [ ] R17: メインエリアにエディタを表示
- [ ] R18: ローディング状態を表示（ページ読み込み時、保存時）
- [ ] R19: エラー状態を表示（ネットワークエラー、保存失敗など）

## Should
- [ ] S1: ページのタイトルで検索時にハイライト表示
- [ ] S2: 最近編集したページを上位に表示（ソートオプション）
- [ ] S3: ページが空の場合はプレースホルダーを表示
- [ ] S4: キーボードショートカット（Cmd+S で保存、Cmd+K で検索など）
- [ ] S5: ダークモード対応

## Could
- [ ] C1: ページのお気に入り機能
- [ ] C2: ブロックのドラッグ&ドロップによる並び替え
- [ ] C3: 削除したページのゴミ箱機能（30日後に完全削除）
- [ ] C4: エクスポート機能（Markdown形式）
- [ ] C5: ページのタグ付け機能

## Decisions (決定済み)
- ✅ **認証方式**: Supabase Auth（Magic Link / Email + Password）
- ✅ **データベース**: PostgreSQL（Supabase Postgres）
- ✅ **エディタ**: Tiptap（ProseMirror-based）
- ✅ **フロントエンド**: Next.js（App Router） + React + TypeScript
- ✅ **スタイリング**: Tailwind CSS
- ✅ **状態管理**: TanStack Query（サーバーキャッシュ）
- ✅ **バリデーション**: Zod
- ✅ **デプロイ**: Vercel（Frontend）+ Supabase（Backend）

## Open Questions (TBD)
- TBD-1: ページ数の上限（無制限 or 制限あり）
- TBD-2: ブロックのネスト（リスト内リストなど）をMVPで対応するか
- TBD-3: オフライン対応の必要性（PWA化するか）
- TBD-4: 検索方式（ILIKE で開始 or 最初からFTS実装）
- TBD-5: ブロック保存形式の詳細（Tiptap JSON をそのまま or カスタムスキーマ）
