# UI (MVP)

## Tech Stack
- **Framework**: Next.js App Router + React
- **Styling**: Tailwind CSS
- **UI Components**: shadcn/ui (optional) / Headless UI
- **Editor**: Tiptap (ProseMirror-based)
- **Icons**: Lucide React
- **Forms**: React Hook Form + Zod

---

## Layout Structure

```
┌─────────────────────────────────────────────────┐
│  Header (App Bar)                               │
│  [Logo] [Search] [User Menu]                    │
├──────────┬──────────────────────────────────────┤
│          │                                      │
│ Sidebar  │  Main Content Area                   │
│          │                                      │
│ - Pages  │  - Page Editor                       │
│   List   │  - Empty State                       │
│          │                                      │
│ [+ New]  │                                      │
│          │                                      │
└──────────┴──────────────────────────────────────┘
```

---

## Screens

### 0. Login / SIgn Up
**Route**: `/login`

**Purpose**: ユーザー認証

**Components**:
- **Auth Form** (Supabase Auth UI)
  - Email/Password 入力欄
  - Sign In / Sign Up 切り替え
  - Social Login (Optional)

**Actions**:
- ログイン成功 → ホーム (`/`) へリダイレクト
- ログイン失敗 → エラーメッセージ表示

---

### 1. Home / Pages List (Sidebar + Empty State)
**Route**: `/` or `/pages`

**Purpose**: ページ一覧表示 + 新規ページ作成の入口

**Components**:
- **Sidebar** (左サイド)
  - ページ一覧（タイトル、更新日時）
  - 新規ページボタン `[+ New Page]`
  - 検索フィールド（サイドバー上部 or Header）
- **Main Area** (メインエリア)
  - Empty State（ページがない場合）
    - 「まだページがありません」
    - 「新規ページを作成してメモを始めましょう」
    - `[+ 新規ページを作成]` ボタン

**Actions**:
- 新規ページボタンをクリック → 新規ページ作成 → エディタ画面へ遷移
- サイドバーのページをクリック → そのページのエディタ画面へ遷移
- 検索フィールドに入力 → ページ一覧をフィルタリング

**States**:
- Loading: スケルトンローダー（ページ一覧）
- Empty: 空状態メッセージ
- Error: エラーメッセージ + リトライボタン

---

### 2. Page Editor (Individual Page)
**Route**: `/pages/:id`

**Purpose**: ページの閲覧・編集

**Components**:
- **Sidebar** (左サイド)
  - 同上（ページ一覧）
  - 現在のページをハイライト表示
- **Main Area** (メインエリア)
  - **Page Header**
    - タイトル入力欄（`<input>` または Tiptap の heading node）
    - メタ情報（作成日時、更新日時）- 右下または下部
    - 削除ボタン（右上 or ヘッダー内）
  - **Editor Area** (Tiptap)
    - ブロックベースのエディタ
    - プレースホルダー: 「何か書いてみましょう...」
    - ホバー時にブロック操作メニュー表示（将来: ドラッグハンドル、削除など）
  - **Auto-save Indicator**
    - 保存状態を表示（「保存済み」「保存中...」「保存失敗」）

**Fields**:
- `title`: string (max 200 chars, optional)
- `blocks`: array of Block (Tiptap JSON format)

**Validation**:
- タイトル: 最大200文字
- ブロック: 特になし（自由入力）

**Actions**:
- タイトル変更 → 自動保存（1秒デバウンス）
- ブロック編集 → 自動保存（1秒デバウンス）
- Auto-save Indicator
    - 保存状態を表示（入力直後に「保存中...」を表示）

- 自動保存は編集停止後1秒でトリガー（デバウンス処理）
- 保存インジケーターは右上または下部に表示（入力即座に「保存中...」→保存完了後「保存済み」）
- 削除ボタン → 確認ダイアログ → ページ削除 → ホームへ遷移
- サイドバーの別ページをクリック → そのページへ遷移

**Error States**:
- 保存失敗 → エラーメッセージ表示 + リトライボタン
- ページ読み込み失敗 → エラーメッセージ + リトライボタン

**Loading States**:
- ページ読み込み中 → スケルトンローダー（タイトル、エディタエリア）
- 保存中 → 保存インジケーター（「保存中...」）

---

### 3. Search Results
**Route**: `/` or `/pages` (same screen, filtered)

**Purpose**: ページを検索してフィルタリング

**Components**:
- **Sidebar**
  - 検索フィールド（上部）
  - フィルタリングされたページ一覧
  - 検索結果が0件の場合: 「該当するページがありません」
- **Main Area**
  - 選択したページのエディタ（通常通り）

**Actions**:
- 検索フィールドに入力 → ページ一覧をリアルタイムフィルタリング
- 検索結果のページをクリック → そのページのエディタ画面へ遷移

---

## Components (最小セット)

### `<Sidebar>`
- Props:
  - `pages: Page[]`
  - `currentPageId?: string`
  - `onPageClick: (id: string) => void`
  - `onNewPage: () => void`
  - `searchQuery: string`
  - `onSearchChange: (query: string) => void`
- Displays:
  - ページ一覧（タイトル、更新日時）
  - 現在のページをハイライト
  - 新規ページボタン
  - 検索フィールド

### `<PageEditor>`
- Props:
  - `page: Page`
  - `onUpdate: (page: Partial<Page>) => void`
  - `onDelete: (id: string) => void`
  - `saveStatus: 'saved' | 'saving' | 'error'`
- Displays:
  - タイトル入力欄
  - Tiptap エディタ
  - メタ情報（作成日時、更新日時）
  - 削除ボタン
  - 保存インジケーター

### `<TiptapEditor>`
- Props:
  - `content: PageContent`
  - `onChange: (content: PageContent) => void`
- Features:
  - ブロックタイプ: paragraph, heading1, heading2, heading3, bulletList, orderedList
  - マークダウンショートカット: `#` 見出し, `-` 箇条書き, `**bold**`, `*italic*`
  - プレースホルダー: 「何か書いてみましょう...」

### `<EmptyState>`
- Displays:
  - メッセージ: 「まだページがありません」
  - CTA: `[+ 新規ページを作成]` ボタン

### `<DeleteConfirmDialog>`
- Props:
  - `isOpen: boolean`
  - `onConfirm: () => void`
  - `onCancel: () => void`
- Displays:
  - 確認メッセージ: 「このページを削除しますか？この操作は取り消せません。」
  - ボタン: `[キャンセル]` `[削除]`

---

## Responsive Design (MVP)

- **Desktop** (推奨): サイドバー常時表示
- **Mobile** (MVP外): サイドバーをハンバーガーメニューに変更（将来対応）

---

## Accessibility (基本対応)

- キーボードナビゲーション対応（Tab, Enter, Escape）
- フォーカス状態の視覚的表示
- セマンティックHTML（`<nav>`, `<main>`, `<header>`など）
- ARIA属性（`aria-label`, `role`など）最小限対応

---

## Notes
- Tiptapはブロック単位での編集をサポート（`Enter`で新規ブロック、`Backspace`でブロック削除）
- 自動保存は編集停止後2秒でトリガー（デバウンス処理）
- 保存インジケーターは右上または下部に表示（「保存済み」「保存中...」「保存失敗」）
